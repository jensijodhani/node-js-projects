<%- include('header')%>

  <div class="page-wrapper">
    <!-- ============================================================== -->
    <!-- Bread crumb and right sidebar toggle -->
    <!-- ============================================================== -->
    <div class="page-breadcrumb">
      <div class="row">
        <div class="col-12 d-flex no-block align-items-center">
          <h4 class="page-title">Form Basic</h4>
          <div class="ms-auto text-end">
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">
                  Library
                </li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </div>
    <!-- ============================================================== -->
    <!-- End Bread crumb and right sidebar toggle -->
    <!-- ============================================================== -->
    <!-- ============================================================== -->
    <!-- Container fluid  -->
    <!-- ============================================================== -->
    <div class="container-fluid">
      <!-- ============================================================== -->
      <!-- Start Page Content -->
      <!-- ============================================================== -->
       
      <div class="row">
        <% if(locals.massage.success) { %>
          <div class="alert alert-success" role="alert">
            <%= locals.massage.success %>
          </div>
          <% } %>

            <div class="col-md-6">
              <div class="card">
                <form class="form-horizontal" method="post" action="/exsubcategory/insertexsubcategory">
                  <div class="card-body">
                    <h4 class="card-title">Add Exsubcategory</h4>
                    <div class="form-group row">
                      <label for="fname" class="col-sm-3 text-end control-label col-form-label">Category</label>
                      <div class="col-sm-9">
                        <select onchange="categoryRecord()" id="category" name="category" class="form-control">
                          <option>--select category--</option>
                          <% category.map((ca)=>{ %>
                            <option value="<%= ca.id %>">
                              <%= ca.category_name %>
                            </option>
                            <% }) %>   
                        </select> 
                      </div>
                    </div>

                    <div class="form-group row">
                      <label for="fname" class="col-sm-3 text-end control-label col-form-label">Subcategory</label>
                      <div class="col-sm-9">
                        <select id="subcategory" name="subcategory" class="form-control">
                          <option>--select subcategory--</option>
                        </select>
                      </div>
                    </div>

                    <div class="form-group row">
                      <label for="fname" class="col-sm-3 text-end control-label col-form-label">Exsubcategory</label>
                      <div class="col-sm-9">
                        <input type="text" class="form-control" id="fname" name="exsubcategory"
                          placeholder="Enter Exsubcategory Name" />
                      </div>
                    </div>

                  </div>
                  <div class="border-top">
                    <div class="card-body">
                      <button type="submit" class="btn btn-primary">
                        Submit
                      </button>
                    </div>
                  </div>
                </form>
              </div>

            </div>

      </div>
      <!-- editor -->

      <!-- ============================================================== -->
      <!-- End PAge Content -->
      <!-- ============================================================== -->
      <!-- ============================================================== -->
      <!-- Right sidebar -->
      <!-- ============================================================== -->
      <!-- .right-sidebar -->
      <!-- ============================================================== -->
      <!-- End Right sidebar -->
      <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- End Container fluid  -->
    <!-- ============================================================== -->
    <!-- ============================================================== -->
    <!-- footer -->
    <!-- ============================================================== -->
    <footer class="footer text-center">
      All Rights Reserved by Matrix-admin. Designed and Developed by
      <a href="https://www.wrappixel.com">WrapPixel</a>.
    </footer>
    <!-- ============================================================== -->
    <!-- End footer -->
    <!-- ============================================================== -->
  </div>

  <!-- ajax -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

  <script>
    const categoryRecord = (req, res) => {
      let catagory = document.getElementById('category').value
      $.ajax({
        type: 'GET',
        url: `/exsubcategory/ajaxsubcategory?id=${catagory}`,
        success: function (res) {
          let tbl = ""
          let category = res.category
          tbl += `<option value="">--select subcategory--</option>`
          category.map((subcat) => {
            console.log(subcat);

            tbl += `
              <option value=${subcat._id}>${subcat.subcategory}</option>  
            `
          })
          document.getElementById('subcategory').innerHTML = tbl;

        }

      })
    }
  </script>


  <%- include('footer')%>